import{l_ as Pe,l$ as ze,iT as Ce,b9 as q,m0 as De,eL as B,aE as $,m1 as I,ah as xe,lo as Le,kI as Ie,m2 as Me,lF as Ne,lS as ne,H as z,b7 as W,m3 as ke,c8 as qe,m4 as K,M as S,fb as ae,eC as re,kT as oe,m5 as ce,eI as j,m6 as We,m7 as le,lp as T,b8 as Z,m8 as he,aB as de,lt as Be,g5 as Ve,m9 as Ge,hN as He,aX as Ue,X as Ke,bh as Qe,aj as Xe,ma as Ye,ay as M,kn as Q,mb as E,bi as X,lG as Je,b5 as ee,g9 as Ee,mc as Ze,f9 as ue,bD as et,md as tt,me as it,km as ge,mf as st,mg as nt,mh as at,dw as _e,ds as v,dm as rt,dx as f,dp as ot,dt as ct,dz as lt,dn as ht,ks as pe,d6 as u,iJ as dt,du as ut,mi as gt,mj as _t,dA as D,fD as pt,B as y,dD as w,dE as F,dF as ft,dH as mt,dI as vt,dK as bt,hs as St,dL as yt,dM as wt,bM as Y,dO as Tt,dP as $t,dQ as Ot,mk as Lt,dG as Et,dV as At,dX as fe,dY as Rt,bK as P,hO as jt,e0 as Ft,fe as x,kc as te,hK as Pt,ml as zt,mm as Ct,mn as Dt,hP as xt,b3 as It,mo as Mt,mp as Ae,ku as Re,mq as Nt,kd as je,mr as kt,bl as qt,ha as Wt,d3 as Bt}from"./vendor.fe24faac.js";class Vt{constructor(e){this.camera=new De,this._elevation={offset:0,override:null},this.collisionType={type:"point"},this.collisionPriority=0,this._renderObjects=[],this.autoScaleRenderObjects=!0,this._available=!0,this._noDisplayCount=0,this._radius=10,this._worldSized=!1,this.focusMultiplier=2,this.touchMultiplier=2.5,this.worldOriented=!1,this._modelTransform=B(),this._worldFrame=null,this._renderLocation=$(),this._renderLocationDirty=!0,this._location=new q({x:0,y:0,z:0}),this._elevationAlignedLocation=new q,this._elevationAlignedLocationDirty=!0,this.interactive=!0,this.selectable=!1,this.grabbable=!0,this.cursor=null,this._grabbing=!1,this.dragging=!1,this._hovering=!1,this._selected=!1,this._state=I.None,this._focused=!1,this.events=new xe.EventEmitter,this._screenLocation={screenPointArray:Le(),renderScreenPointArray:Ie(),pixelSize:0},this._screenLocationDirty=!0,this._applyObjectTransform=null,this._engineResourcesAddedToStage=!1,this._engineResources=null,this._attached=!1,this._engineLayer=null,this._materialIdReferences=null,this._location.spatialReference=e.view.spatialReference;for(const t in e)this[t]=e[t];this.view.state&&this.view.state.camera&&this.camera.copyFrom(this.view.state.camera)}destroy(){this._removeResourcesFromStage(),this._engineResources=null,this.view=null,this.camera=null}get elevationInfo(){return this._elevationInfo}set elevationInfo(e){this._elevationInfo=e,this._elevationAlignedLocationDirty=!0,this._renderLocationDirty=!0,this._updateEngineObject()}get renderObjects(){return this._renderObjects}set renderObjects(e){this._removeResourcesFromStage(),this._engineResources=null,this._renderObjects=e.slice(),this._updateEngineObject()}set available(e){e!==this._available&&(this._available=e,this._updateEngineObject())}get available(){return this._available}disableDisplay(){return this._noDisplayCount++,this._noDisplayCount===1&&this._updateEngineObject(),{remove:Me(()=>{this._noDisplayCount--,this._noDisplayCount===0&&this._updateEngineObject()})}}set radius(e){e!==this._radius&&(this._radius=e,this._updateEngineObject())}get radius(){return this._radius}set worldSized(e){e!==this._worldSized&&(this._worldSized=e,this._updateEngineObject())}get worldSized(){return this._worldSized}get modelTransform(){return this._modelTransform}set modelTransform(e){me(e)&&(this._screenLocationDirty=!0),Ne(this._modelTransform,e),this._updateEngineObject()}get renderLocation(){return this._renderLocationDirty&&(this._renderLocationDirty=!1,this.view.renderCoordsHelper.toRenderCoords(this.elevationAlignedLocation,this._renderLocation),this.worldOriented?(this._worldFrame||(this._worldFrame=B()),Gt(this.view,this._renderLocation,this._worldFrame)):this._worldFrame&&(this._worldFrame=null)),this._renderLocation}set renderLocation(e){this.view.renderCoordsHelper.fromRenderCoords(e,this._location),this.elevationAlignedLocation=this._location}get location(){return this._location}set location(e){ne(e,this._location),this._renderLocationDirty=!0,this._screenLocationDirty=!0,this._elevationAlignedLocationDirty=!0,this._updateEngineObject(),this.events.emit("location-update",{location:this._location})}get elevationAlignedLocation(){return this._elevationAlignedLocationDirty?(this._evaluateElevationAlignment(),this._updateElevationAlignedLocation(),this._elevationAlignedLocation):this._elevationAlignedLocation}set elevationAlignedLocation(e){ne(e,this._location),this._evaluateElevationAlignment(),this._location.z-=this._elevation.offset,this._updateElevationAlignedLocation(),this._updateEngineObject(),this.events.emit("location-update",{location:this._location})}_updateElevationAlignedLocation(){this._elevationAlignedLocation.x=this.location.x,this._elevationAlignedLocation.y=this.location.y;const e=z(this._elevation.override)?this._elevation.override:this.location.z||0;this._elevationAlignedLocation.z=e+this._elevation.offset,this._elevationAlignedLocation.spatialReference=this.location.spatialReference,this._renderLocationDirty=!0,this._screenLocationDirty=!0,this._elevationAlignedLocationDirty=!1}grabbableForEvent(){return!0}get grabbing(){return this._grabbing}set grabbing(e){e!==this._grabbing&&(this._grabbing=e,this._setFocused(this._hovering||this._grabbing),this._updateEngineObject())}get hovering(){return this._hovering}set hovering(e){e!==this._hovering&&(this._hovering=e,this._setFocused(this._hovering||this._grabbing),this._updateEngineObject())}get selected(){return this._selected}set selected(e){e!==this._selected&&(this._selected=e,this._updateEngineObject(),this.events.emit("select-changed",{action:e?"select":"deselect"}))}get state(){return this._state}set state(e){e!==this._state&&(this._state=e,this._updateEngineObject())}updateStateEnabled(e,t){t?this.state|=e:this.state&=~e}_setFocused(e){e!==this._focused&&(this._focused=e,this.events.emit("focus-changed",{action:e===!0?"focus":"unfocus"}))}get focused(){return this._focused}get screenLocation(){return this._ensureScreenLocation(),this._screenLocation}_ensureScreenLocation(){if(!this._screenLocationDirty)return;this._screenLocation.pixelSize=this.camera.computeScreenPixelSizeAt(this.renderLocation),this._screenLocationDirty=!1;let e;if(me(this._modelTransform)){const t=this._calculateModelTransformOffset(Kt);e=W(t,t,this.renderLocation)}else e=this.renderLocation;this.camera.projectToRenderScreen(e,this._screenLocation.renderScreenPointArray),this.camera.renderToScreen(this._screenLocation.renderScreenPointArray,this._screenLocation.screenPointArray)}get applyObjectTransform(){return this._applyObjectTransform}set applyObjectTransform(e){this._applyObjectTransform=e,this._screenLocationDirty=!0,this._updateEngineObject()}intersectionDistance(e,t){var r;if(!this.available)return null;const i=ke(e,Ht),n=this._getCollisionRadius(t),a=-1*this.collisionPriority;switch(this.collisionType.type){case"point":if(He(this.screenLocation.screenPointArray,i)<n*n)return this.screenLocation.renderScreenPointArray[2]+a;break;case"line":{const o=this.collisionType.paths,h=this._getWorldToScreenObjectScale(),g=this._calculateObjectTransform(h,N),c=n*this.screenLocation.pixelSize,d=K(this.camera,i,J);if(S(d))return null;for(const l of o){if(l.length===0)continue;const m=j(C,l[0],g);for(let p=1;p<l.length;p++){const _=j(Se,l[p],g),O=Ge(le(m,_,ve),d);if(O!=null&&O<c*c){const L=W(T.get(),m,_);Z(L,L,.5);const R=he(T.get());return this.camera.projectToRenderScreen(L,R),R[2]+a}de(m,_)}}break}case"disc":{const o=this.collisionType.direction,h=(r=this.collisionType.offset)!=null?r:Be,g=this._getWorldToScreenObjectScale(),c=this._calculateObjectTransform(g,N),d=n*this.screenLocation.pixelSize,l=K(this.camera,i,J);if(S(l))return null;const m=ae(be,c),p=re(we,o,m),_=j(Te,h,c);oe(_,p,k);const O=ye;if(ce(k,l,O)&&Ve(O,_)<d*d)return this.screenLocation.renderScreenPointArray[2]+a;break}case"ribbon":{const{paths:o,direction:h}=this.collisionType,g=this._getWorldToScreenObjectScale(),c=this._calculateObjectTransform(g,N),d=n*this.camera.computeScreenPixelSizeAt(this.renderLocation),l=K(this.camera,i,J);if(S(l))return null;const m=ae(be,c),p=re(we,h,m),_=this._calculateModelTransformPosition(Te);oe(_,p,k);const O=ye;if(!ce(k,l,O))break;for(const L of o){if(L.length===0)continue;const R=j(C,L[0],c);for(let G=1;G<L.length;G++){const H=j(Se,L[G],c),ie=We(le(R,H,ve),O);if(ie!=null&&ie<d*d){const U=W(T.get(),R,H);Z(U,U,.5);const se=he(T.get());return this.camera.projectToRenderScreen(U,se),se[2]+a}de(R,H)}}break}default:qe(this.collisionType)}return null}attach(e={manipulator3D:{}}){var i;if(!this.view._stage)return;const t=e.manipulator3D;if(S(t.engineLayerId)){const n=new Ue({isPickable:!1,updatePolicy:Ke.SYNC});this.view._stage.add(n),t.engineLayerId=n.id,this._engineLayer=n}else((i=this.view._stage)==null?void 0:i.getObject)&&(this._engineLayer=this.view._stage.getObject(t.engineLayerId));t.engineLayerReferences=(t.engineLayerReferences||0)+1,this._materialIdReferences=t.materialIdReferences,S(this._materialIdReferences)&&(this._materialIdReferences=new Map,t.materialIdReferences=this._materialIdReferences),this.camera.copyFrom(this.view.state.camera),this._attached=!0,this._updateEngineObject(),Qe(this._location.spatialReference,this.view.spatialReference)||(this.location=new q({x:0,y:0,z:0,spatialReference:this.view.spatialReference}))}detach(e={manipulator3D:{}}){const t=e.manipulator3D;t.engineLayerReferences--;const i=t.engineLayerReferences===0;i&&(t.engineLayerId=null),this._removeResourcesFromStage(i),this._engineResources=null,this._engineLayer=null,this._materialIdReferences=null,this._attached=!1}onViewChange(){this.camera.copyFrom(this.view.state.camera),this._screenLocationDirty=!0,this._updateEngineObject()}onElevationChange(e){Xe(this.location,$e,e.spatialReference),Ye(e.extent,$e)&&(this.location=this._location)}_evaluateElevationAlignment(e=this.location){if(S(this.elevationInfo))return!1;let t=null,i=0;const n=M(this.elevationInfo.offset,0);switch(this.elevationInfo.mode){case"on-the-ground":t=M(Q(this.view.elevationProvider,e,"ground"),0);break;case"relative-to-ground":i=M(Q(this.view.elevationProvider,e,"ground"),0)+n;break;case"relative-to-scene":i=M(Q(this.view.elevationProvider,e,"scene"),0)+n;break;case"absolute-height":i=n}return(i!==this._elevation.offset||t!==this._elevation.override)&&(this._elevation.offset=i,this._elevation.override=t,!0)}_updateEngineObject(){if(!this._attached)return;if(!this.available)return void this._removeResourcesFromStage();const e=this._getWorldToScreenObjectScale(),t=N;if(this.autoScaleRenderObjects===!0){const r=this._getFocusedSize(this._radius,this.focused)*e;this._calculateObjectTransform(r,t)}else this._calculateObjectTransform(e,t);const{objectsByState:i}=this._ensureEngineResources(),n=(this.focused?E.Focused:E.Unfocused)|(this.selected?E.Selected:E.Unselected),a=this._noDisplayCount>0;for(const{stateMask:r,objects:o}of i){if(a){for(const l of o)l.setVisible(!1);continue}const h=(r&E.All)!==E.None,g=(r&I.All)!==I.None,c=!h||(n&r)==(r&E.All),d=!g||(this.state&r)==(r&I.All);if(c&&d)for(const l of o)l.setVisible(!0),l.transformation=t;else for(const l of o)l.setVisible(!1)}}_ensureEngineResources(){if(S(this._engineResources)){const e=X(this._engineLayer),t=[],i=new Set;this.renderObjects.forEach(({material:o})=>{i.has(o)||(t.push(o),i.add(o))});const n=(o,h)=>{const{geometry:g,material:c,transform:d}=h;Array.isArray(g)?g.forEach(l=>o.addGeometry(l,c,d)):o.addGeometry(g,c,d)},a=new Map;this._renderObjects.forEach(o=>{const h=new Je({castShadow:!1});n(h,o);const g=o.stateMask||0,c=a.get(g)||[];c.push(h),a.set(g,c)});const r=[];a.forEach((o,h)=>r.push({stateMask:h,objects:o})),this._engineResources={objectsByState:r,layer:e,materials:t}}return this._addResourcesToStage(),this._engineResources}_addResourcesToStage(){if(this._engineResourcesAddedToStage||S(this._engineResources))return;const{objectsByState:e,layer:t,materials:i}=this._engineResources;i.forEach(n=>{const a=X(this._materialIdReferences),r=a.get(n.id)||0;r===0&&this.view._stage.add(n),a.set(n.id,r+1)}),e.forEach(({objects:n})=>{t.addMany(n),this.view._stage.addMany(n)}),this._engineResourcesAddedToStage=!0}_removeResourcesFromStage(e=!1){if(!this._engineResourcesAddedToStage||S(this._engineResources)||!this.view._stage)return;const{objectsByState:t,layer:i,materials:n}=this._engineResources;t.forEach(({objects:a})=>{i.removeMany(a),this.view._stage.removeMany(a)}),n.forEach(a=>{const r=X(this._materialIdReferences),o=r.get(a.id);o===1?(this.view._stage.remove(a),r.delete(a.id)):r.set(a.id,o-1)}),e&&this.view._stage.remove(i),this._engineResourcesAddedToStage=!1}_getCollisionRadius(e){return this._getFocusedSize(this.radius,!0)*(e==="touch"?this.touchMultiplier:1)}_getFocusedSize(e,t){return e*(t?this.focusMultiplier:1)}_getWorldToScreenObjectScale(){return this._worldSized?1:this.screenLocation.pixelSize}_calculateModelTransformPosition(e){const t=this._getWorldToScreenObjectScale(),i=this._calculateObjectTransform(t,Ut);return ee(e,i[12],i[13],i[14])}_calculateModelTransformOffset(e){const t=this._calculateModelTransformPosition(e);return Ee(e,t,this.renderLocation)}_calculateObjectTransform(e,t){return Ze(t,e,0,0,0,0,e,0,0,0,0,e,0,0,0,0,1),this._worldFrame&&ue(t,t,this._worldFrame),ue(t,t,this._modelTransform),t[12]+=this.renderLocation[0],t[13]+=this.renderLocation[1],t[14]+=this.renderLocation[2],t[15]=1,z(this._applyObjectTransform)&&this._applyObjectTransform(t),t}get test(){let e=!1;if(z(this._engineResources))for(const t in this._engineResources.objectsByState){const i=this._engineResources.objectsByState[t];for(const n of i.objects)if(n.isVisible){e=!0;break}if(e)break}return{areAnyResourcesVisible:e}}}function me(s){return s[12]!==0||s[13]!==0||s[14]!==0}function Gt(s,e,t){switch(s.viewingMode){case"local":return st(t),!0;case"global":{const i=et(s.renderCoordsHelper.spatialReference);return tt(e,0,C,0,i.radius),it(ge(C[0]),ge(C[1]),t),!0}}}const Ht=Le(),ve=Pe(),J=ze(),be=nt(),Ut=B(),N=B(),k=Ce(),C=$(),Se=$(),ye=$(),we=$(),Te=$(),Kt=$(),$e=new q({x:0,y:0,z:0,spatialReference:null});function Qt(s,e){if(!e.screenSizeEnabled)return;const t=s.vertex;at(t,e),t.uniforms.add(new _e("perScreenPixelRatio",(i,n)=>n.camera.perScreenPixelRatio)),t.uniforms.add(new _e("screenSizeScale",i=>i.screenSizeScale)),t.code.add(v`float computeRenderPixelSizeAt( vec3 pWorld ){
vec3 viewForward = - vec3(view[0][2], view[1][2], view[2][2]);
float viewDirectionDistance = abs(dot(viewForward, pWorld - cameraPosition));
return viewDirectionDistance * perScreenPixelRatio;
}
vec3 screenSizeScaling(vec3 position, vec3 anchor){
return position * screenSizeScale * computeRenderPixelSizeAt(anchor) + anchor;
}`)}function Xt(s){const e=new rt,t=s.hasMultipassTerrain&&(s.output===f.Color||s.output===f.Alpha);e.include(ot),e.include(Qt,s),e.include(ct,s);const{vertex:i,fragment:n}=e;return n.include(lt),ht(e,s),n.uniforms.add(new pe("uColor",a=>a.color)),e.attributes.add(u.POSITION,"vec3"),e.varyings.add("vWorldPosition","vec3"),t&&e.varyings.add("depth","float"),s.screenSizeEnabled&&e.attributes.add(u.OFFSET,"vec3"),s.shadingEnabled&&(i.uniforms.add(new dt("viewNormal",(a,r)=>r.camera.viewInverseTransposeMatrix)),e.attributes.add(u.NORMAL,"vec3"),e.varyings.add("vViewNormal","vec3")),i.code.add(v`
    void main(void) {
      vWorldPosition = ${s.screenSizeEnabled?"screenSizeScaling(offset, position)":"position"};
  `),s.shadingEnabled&&i.code.add(v`vec3 worldNormal = normal;
vViewNormal = (viewNormal * vec4(worldNormal, 1)).xyz;`),i.code.add(v`
    ${t?"depth = (view * vec4(vWorldPosition, 1.0)).z;":""}
    gl_Position = transformPosition(proj, view, vWorldPosition);
  }
  `),t&&e.include(ut,s),n.code.add(v`
    void main() {
      discardBySlice(vWorldPosition);
      ${t?"terrainDepthTest(gl_FragCoord, depth);":""}
    `),s.shadingEnabled?(n.uniforms.add(new gt("shadingDirection",a=>a.shadingDirection)),n.uniforms.add(new pe("shadedColor",a=>Yt(a.shadingTint,a.color))),n.code.add(v`vec3 viewNormalNorm = normalize(vViewNormal);
float shadingFactor = 1.0 - clamp(-dot(viewNormalNorm, shadingDirection), 0.0, 1.0);
vec4 finalColor = mix(uColor, shadedColor, shadingFactor);`)):n.code.add(v`vec4 finalColor = uColor;`),n.code.add(v`
      if (finalColor.a < ${v.float(_t)}) {
        discard;
      }
      ${s.output===f.Alpha?v`gl_FragColor = vec4(finalColor.a);`:""}

      ${s.output===f.Color?v`gl_FragColor = highlightSlice(finalColor, vWorldPosition); ${s.transparencyPassType===D.Color?"gl_FragColor = premultiplyAlpha(gl_FragColor);":""}`:""}
    }
    `),e}function Yt(s,e){const t=1-s[3],i=s[3]+e[3]*t;return i===0?(A[3]=i,A):(A[0]=(s[0]*s[3]+e[0]*e[3]*t)/i,A[1]=(s[1]*s[3]+e[1]*e[3]*t)/i,A[2]=(s[2]*s[3]+e[2]*e[3]*t)/i,A[3]=e[3],A)}const A=pt(),Jt=Object.freeze(Object.defineProperty({__proto__:null,build:Xt},Symbol.toStringTag,{value:"Module"}));class V extends mt{initializeProgram(e){const t=V.shader.get().build(this.configuration);return new vt(e.rctx,t,Fe)}_setPipelineState(e){const t=this.configuration,i=e===D.NONE,n=e===D.FrontFace;return bt({blending:t.output!==f.Color&&t.output!==f.Alpha||!t.transparent?null:i?St:yt(e),culling:wt(t.cullFace),depthTest:{func:n?Y.LESS:t.shadingEnabled?Y.LEQUAL:Y.LESS},depthWrite:i?t.writeDepth&&Tt:$t(e),colorWrite:Ot,polygonOffset:i||n?null:Lt})}initializePipeline(){return this._setPipelineState(this.configuration.transparencyPassType)}}V.shader=new Et(Jt,()=>import("./ShadedColorMaterial.glsl.db38d2f1.js"));class b extends ft{constructor(){super(...arguments),this.output=f.Color,this.cullFace=F.None,this.transparencyPassType=D.NONE,this.hasSlicePlane=!1,this.transparent=!1,this.writeDepth=!0,this.screenSizeEnabled=!0,this.shadingEnabled=!0,this.hasMultipassTerrain=!1,this.cullAboveGround=!1}}y([w({count:f.COUNT})],b.prototype,"output",void 0),y([w({count:F.COUNT})],b.prototype,"cullFace",void 0),y([w({count:D.COUNT})],b.prototype,"transparencyPassType",void 0),y([w()],b.prototype,"hasSlicePlane",void 0),y([w()],b.prototype,"transparent",void 0),y([w()],b.prototype,"writeDepth",void 0),y([w()],b.prototype,"screenSizeEnabled",void 0),y([w()],b.prototype,"shadingEnabled",void 0),y([w()],b.prototype,"hasMultipassTerrain",void 0),y([w()],b.prototype,"cullAboveGround",void 0);const Fe=new Map([[u.POSITION,0],[u.NORMAL,1],[u.OFFSET,2]]);class Zt extends At{constructor(e){super(e,new ti),this.supportsEdges=!0,this.techniqueConfig=new b,this._vertexAttributeLocations=Fe}getConfiguration(e,t){return this.techniqueConfig.output=e,this.techniqueConfig.cullFace=this.parameters.cullFace,this.techniqueConfig.hasSlicePlane=this.parameters.hasSlicePlane,this.techniqueConfig.transparent=this.parameters.transparent,this.techniqueConfig.writeDepth=this.parameters.writeDepth,this.techniqueConfig.screenSizeEnabled=this.parameters.screenSizeEnabled,this.techniqueConfig.shadingEnabled=this.parameters.shadingEnabled,this.techniqueConfig.transparencyPassType=t.transparencyPassType,this.techniqueConfig.hasMultipassTerrain=t.multipassTerrain.enabled,this.techniqueConfig.cullAboveGround=t.multipassTerrain.cullAboveGround,this.techniqueConfig}intersect(e,t,i,n,a,r,o){if(this.parameters.screenSizeEnabled){const h=e.vertexAttributes.get(u.OFFSET);fe(e,t,n,a,r,{applyToVertex:(c,d,l,m)=>{const p=ee(Oe,h.data[3*m+0],h.data[3*m+1],h.data[3*m+2]),_=ee(si,c,d,l);return Z(p,p,this.parameters.screenSizeScale*n.camera.computeRenderPixelSizeAt(p)),W(_,_,p),[_[0],_[1],_[2]]},applyToAabb:c=>{const d=It(c,Oe);return Mt(c,this.parameters.screenSizeScale*n.camera.computeRenderPixelSizeAt(d))}},o)}else fe(e,t,n,a,r,void 0,o)}requiresSlot(e,t){if(Rt(t)===f.Highlight)return e===P.OPAQUE_MATERIAL;let i=P.OPAQUE_MATERIAL;return this.parameters.transparent&&(i=this.parameters.writeDepth?P.TRANSPARENT_MATERIAL:P.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL),e===i||e===P.DRAPED_MATERIAL}createGLMaterial(e){return e.output===f.Color||e.output===f.Alpha||e.output===f.Highlight?new ei(e):null}createBufferWriter(){return new ii(this.parameters.screenSizeEnabled)}}class ei extends jt{beginSlot(e){return this.ensureTechnique(V,e)}}class ti extends Ft{constructor(){super(...arguments),this.color=x(1,1,1,1),this.shadingTint=x(0,0,0,.25),this.shadingDirection=te($(),[.5,-.5,-.5]),this.screenSizeScale=14,this.transparent=!1,this.writeDepth=!0,this.hasSlicePlane=!1,this.cullFace=F.None,this.screenSizeEnabled=!1,this.shadingEnabled=!0}}class ii{constructor(e){this.screenSizeEnabled=e;const t=Pt().vec3f(u.POSITION).vec3f(u.NORMAL);this.screenSizeEnabled&&t.vec3f(u.OFFSET),this.vertexBufferLayout=t}allocate(e){return this.vertexBufferLayout.createBuffer(e)}elementCount(e){return e.indices.get(u.POSITION).length}write(e,t,i,n){if(zt(t,this.vertexBufferLayout,e.transformation,e.invTranspTransformation,i,n),this.screenSizeEnabled){if(!t.vertexAttributes.has(u.OFFSET))throw new Error(`${u.OFFSET} vertex attribute required for screenSizeEnabled ShadedColorMaterial`);{const a=t.vertexAttributes.get(u.OFFSET),r=t.indices.get(u.OFFSET);Ct(a.size===3);const o=i.getField(u.OFFSET,Dt);if(!o)throw new Error("unable to acquire view for "+u.OFFSET);xt(r,a.data,e.invTranspTransformation,o,n)}}}}const Oe=$(),si=$();function ni(s,e=Re.OccludeAndTransparent,t=!0){const i=x(s[0],s[1],s[2],s.length>3?s[3]:1),n=s[3]<1;return t?new Zt({color:i,transparent:n,writeDepth:!0,cullFace:F.Back,renderOccluded:e}):new Ae({color:i,transparent:n,writeDepth:!0,cullFace:F.Back,renderOccluded:e})}function li(s,e=Re.OccludeAndTransparent){const t=x(s[0],s[1],s[2],s.length===4?s[3]:1);return new Ae({color:t,transparent:!0,writeDepth:!0,cullFace:F.Front,renderOccluded:e})}function hi(s,e,t){return new Vt({view:s,renderObjects:[{geometry:Bt.createSphereGeometry(1,32,32),material:ni(x(e[0],e[1],e[2],t!=null?t:1))}]})}function di(s,e,t,i){const n=Ee(T.get(),s,t),a=ai(n,je(T.get(),i,n),t,Nt.get());kt(a,a);const r=j(T.get(),e,a);return Math.atan2(r[1],r[0])}function ai(s,e,t,i){const n=te(T.get(),s),a=te(T.get(),e),r=je(T.get(),n,a);return i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=0,i[4]=a[0],i[5]=a[1],i[6]=a[2],i[7]=0,i[8]=r[0],i[9]=r[1],i[10]=r[2],i[11]=0,i[12]=t[0],i[13]=t[1],i[14]=t[2],i[15]=1,i}function ri(s,e){const t=s.getViewForGraphic(e);return z(t)&&"computeAttachmentOrigin"in t?t.computeAttachmentOrigin(e,s.spatialReference):null}function ui(s,e,t){const i=ri(s,t);z(i)?e.elevationAlignedLocation=i:oi(e,t.geometry)}function oi(s,e){if(S(e))return;const t=e.type==="mesh"?e.anchor:qt(e);S(t)||(s.location=Wt(t))}export{ri as F,di as O,li as b,Xt as f,ai as k,Zt as q,Vt as t,ui as v,ni as w,hi as y};
