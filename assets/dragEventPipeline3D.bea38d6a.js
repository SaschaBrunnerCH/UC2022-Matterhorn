var P=Object.defineProperty,U=Object.defineProperties;var k=Object.getOwnPropertyDescriptors;var R=Object.getOwnPropertySymbols;var A=Object.prototype.hasOwnProperty,h=Object.prototype.propertyIsEnumerable;var H=(n,e,t)=>e in n?P(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,f=(n,e)=>{for(var t in e||(e={}))A.call(e,t)&&H(n,t,e[t]);if(R)for(var t of R(e))h.call(e,t)&&H(n,t,e[t]);return n},E=(n,e)=>U(n,k(e));import{l$ as q,m3 as $,mv as T,mw as G,m4 as M,H as c,m5 as v,M as y,aE as d,mx as F,my as j,lo as x,aj as w,kd as C,kT as z,aB as I,iT as B,g9 as g,fG as b,mz as _,g7 as J,b8 as K,b7 as L,au as Q,av as V,ay as W,mA as D,eM as X}from"./vendor.fe24faac.js";import{G as Y}from"./InteractiveToolBase.e7b97dce.js";function Z(n,e){return O(n,()=>e)}function pn(n){return O(n,e=>e.plane)}function O(n,e){const t=d(),s=d();let a=!1;return r=>{const l=e(r);if(r.action==="start"){const i=$(r.screenStart,T(G.get())),u=M(n.state.camera,i,N);c(u)&&(a=v(l,u,t))}if(!a)return null;const o=$(r.screenEnd,T(G.get())),p=M(n.state.camera,o,N);return y(p)?null:v(l,p,s)?E(f({},r),{renderStart:t,renderEnd:s,plane:l,ray:p}):null}}function nn(n,e,t,s=null,a=null){let r=null;return l=>{if(l.action==="start"&&(r=n.sceneIntersectionHelper.intersectElevationFromScreen(x(l.screenStart.x,l.screenStart.y),e,t,a),c(r)&&c(s)&&!w(r,r,s))||y(r))return null;const o=n.sceneIntersectionHelper.intersectElevationFromScreen(x(l.screenEnd.x,l.screenEnd.y),e,t,a);return c(o)?c(s)&&!w(o,o,s)?null:E(f({},l),{mapStart:r,mapEnd:o}):null}}function en(n,e,t,s=null,a=null){return nn(n,t,j(e,n,t),s,a)}function tn(n,e,t,s=null,a=null){return en(n,t,F(e),s,a)}function mn(n,e,t,s){const a=e.toMap(n.screenStart,{include:[t]});return c(a)?tn(e,t,a,s):null}function rn(n,e){const t=on,s=ln,a=B();n.renderCoordsHelper.worldUpAtPosition(e,t);const r=C(a,t,g(s,e,n.state.camera.eye));return C(r,r,t),z(e,r,a)}function fn(n,e,t){let s=null;const a=new Y;return a.next(Z(n,rn(n,e))).next(sn(n,e)).next(an(n,t)).next(r=>{r.mapEnd.x=r.mapStart.x,r.mapEnd.y=r.mapStart.y,s=r}),r=>(s=null,a.execute(r),s)}function sn(n,e){const t=d(),s=b(e);n.renderCoordsHelper.worldUpAtPosition(e,t);const a=d(),r=d(),l=o=>(g(o,o,e),_(t,o,o),n.viewingMode==="global"&&b(o)*Math.sign(J(t,o))<.001-s&&g(o,K(o,t,.001),e),L(o,o,e),o);return o=>(o.renderStart=l(I(a,o.renderStart)),o.renderEnd=l(I(r,o.renderEnd)),o)}function an(n,e){const t=n.renderCoordsHelper;return s=>{const a=t.fromRenderCoords(s.renderStart,e),r=t.fromRenderCoords(s.renderEnd,e);return c(a)&&c(r)?E(f({},s),{mapStart:a,mapEnd:r}):null}}var S;function En(n){let e=null;return t=>{switch(t.action){case"start":e=n.disableDisplay();break;case"end":case"cancel":c(e)&&(e.remove(),e=null)}return t}}function Sn(n,e=null){const t=Q(n.state.viewingMode);t.options.selectionMode=!0,t.options.store=V.MIN,t.options.hud=!1;const s=x(),a={requiresGroundFeedback:!0,enableDraped:!0,exclude:new Set},r=d(),l=W(e,n.spatialReference),o=i=>{n.map.ground&&n.map.ground.opacity<1?a.exclude.add(D):a.exclude.delete(D),n.sceneIntersectionHelper.intersectIntersectorScreen($(i,s),t,a);const u=t.results.min;let m;if(u.getIntersectionPoint(r))m=u.intersector===X.TERRAIN?S.GROUND:S.OTHER;else{if(!t.results.ground.getIntersectionPoint(r))return null;m=S.GROUND}return{location:n.renderCoordsHelper.fromRenderCoords(r,l),surfaceType:m}};let p;return i=>{if(i.action==="start"){const m=o(i.screenStart);p=c(m)?m.location:null}if(y(p))return null;const u=o(i.screenEnd);return c(u)&&c(u.location)?E(f({},i),{mapStart:p,mapEnd:u.location,surfaceType:u.surfaceType}):null}}(function(n){n[n.GROUND=0]="GROUND",n[n.OTHER=1]="OTHER"})(S||(S={}));const on=d(),ln=d(),N=q();export{Sn as B,Z as C,an as F,fn as G,en as N,tn as P,pn as T,mn as h,En as z};
